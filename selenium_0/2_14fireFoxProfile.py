#! /usr/bin/python#! coding=UTF-8"""练习百度阅读python selenium 一书练习启动浏览器时自动加载浏览器的配置文件，这样 在打开浏览器时，就不是在新窗口中打开了，而是在原来的页签中打开"""from time import sleepfrom selenium import webdriver# driver = webdriver.Chrome()from selenium.webdriver import ActionChainsfrom selenium.webdriver.support.select import Select# driver = webdriver.Firefox()# driver.get("http://www.baidu.com")# 以下是两种定位方式，均可# driver.find_element_by_id('kw').send_keys('selenium')# driver.find_element('id','kw').send_keys('selenium')# driver.find_element_by_id('su').click()# driver.find_element('id','su').click()# # 悬浮到设置按钮上# mouse = driver.find_element_by_link_text("设置")# ActionChains(driver).move_to_element(mouse).perform()## # 点击搜索设置按钮# driver.find_element_by_link_text("搜索设置").click()## # 点击select项# s = driver.find_element_by_id('nr')# Select(s).select_by_index(1)## driver.find_element_by_link_text('保存设置').click()### sleep(5)## driver.quit()# 点击新闻按钮# driver.find_element_by_link_text("新闻").click()# 配置文件地址profile_dir = r"/Users/fujunmin/Library/Application Support/Firefox/Profiles/v8bdwqqc.default"# 加载配置文件profile = webdriver.FirefoxProfile(profile_dir)driver = webdriver.Firefox(profile)# driver = webdriver.Firefox()driver.get('http://www.baidu.com')print driver.current_window_handleprint driver.window_handles# driver.find_element_by_link_text("新闻").click()   #因为加载了配置文件，会在新的窗口中打开这个链接# all_h = driver.window_handles# print driver.window_handles# print driver.current_url# driver.switch_to_window(all_h[1])# print driver.current_url# print driver.title# driver.find_element_by_partial_link_text("习近平").click()# 修改元素的target属性,解决：加载了配置文件后在新窗口中打开链接js = 'document.getElementsByClassName("mnav")[0].target="";'driver.execute_script(js)driver.find_element_by_link_text("新闻").click()   #因为加载了配置文件，会在新的窗口中打开这个链接sleep(5)driver.quit()